/**
 * ngNavigation - v0.0.1
 *
 * Copyright (c) 2015 David Vuong <david.vuong256@gmail.com>
 * Licensed MIT
 */
!function(a){a.service("Navigation",["$rootScope","$window","$location",function(a,b,c){var d=this,e={appendSlash:!1,stripSlash:!1,rootRoute:void 0,ignoreRoutes:[]};d._endsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)},d._overrideDefaults=function(a){if(a&&(angular.forEach(a,function(a,b){angular.isDefined(a)&&(e[b]=a)}),e.appendSlash&&e.stripSlash))throw"options.appendSlash and options.stripSlash are mutually exclusive"},d._deconstructUrlPath=function(a){for(var b,c=/\+/g,d=/([^&=]+)=?([^&]*)/g,e=function(a){return decodeURIComponent(a.replace(c," "))},f=a.split(/\?(.+)?/),g=f[0],h=f.slice(1,-1).join("&"),i={};b=d.exec(h);)i[e(b[1])]=e(b[2]);return{url:g,params:i}},d._route=function(a,b){return b?c.path(a).search(b):c.path(a)},d._routeChangeListener=function(a,b,c){if(d._isClearing)return void(d._isClearing=!1);if(!d._isRouting&&b){if(a===e.rootRoute)return d.clearRouteStack();a===d.peakRouteStack().url&&d._routeStack.pop(),-1===e.ignoreRoutes.indexOf(b)&&(d._isRouting=!0,d.pushToRouteStack(b,c),d._isRouting=!1)}},d._isUiRouterInstalled=function(){try{angular.module("ui.router")}catch(a){return!1}return!0},d._listenToRouteChange=function(){var b,c;d._isUiRouterInstalled()?(b="$stateChangeSuccess",c=function(a,b,c,e,f){e.name&&d._routeChangeListener(b.url,e.url,f)}):(b="$routeChangeSuccess",c=function(a,b,c){c&&d._routeChangeListener(b.originalPath,c.originalPath,c.params)}),a.$on(b,c)},d.init=function(a){this._hasInit||(d._overrideDefaults(a),d._hasInit=!0,d._isClearing=!1,d._isRouting=!1,d._routeStack=[],d._listenToRouteChange())},d.peakRouteStack=function(){return d._routeStack[d._routeStack.length-1]||{}},d.pushToRouteStack=function(a,b){if(b=b||{},a){var c=d._deconstructUrlPath(a);if(c.params&&!angular.equals(c.params,{})&&(a=c.url,b.params=c.params),b.params=b.params||{},e.appendSlash&&!d._endsWith(a,"/")&&(a+="/"),e.stripSlash&&d._endsWith(a,"/")&&(a=a.substring(0,a.length-1)),d.peakRouteStack().url!==a){var f={url:a,params:b.params,label:b.label};d._routeStack.push(f)}}},d.routeTo=function(a,b){if(!d._isRouting){b=b||{},d._isRouting=!0,b.clearStack&&d.clearRouteStack();var c=d._deconstructUrlPath(a);c.params&&!angular.equals(c.params,{})&&(a=c.url,b.params=c.params),b.params=b.params||{},d._route(a,b.params),d._isRouting=!1}},d.routeBack=function(a){a=a||{};var c=d.isBackRouteAvailable(),e=!angular.equals(a,{});return c||e?!c&&e?d._route(a.url,a.params||{}):(d._routeStack.pop(),d._isClearing=!0,b.history.back()):void 0},d.isBackRouteAvailable=function(){return!!d._routeStack.length},d.clearRouteStack=function(){d._routeStack.length=0,d._isClearing=!0},d.getRouteStack=function(){return d._routeStack},d.getDefaultOptions=function(){return e}}])}(angular.module("ngNavigation",[]));