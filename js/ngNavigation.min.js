/**
 * ng-navigation - v0.0.1
 *
 * Copyright (c) 2015 David Vuong <david.vuong256@gmail.com>
 * Licensed MIT
 */
!function(a){a.service("Navigation",["$rootScope","$window","$location",function(a,b,c){function d(a,b){return-1!==a.indexOf(b,a.length-b.length)}function e(a){if(a&&(angular.forEach(a,function(a,b){angular.isDefined(a)&&(i[b]=a)}),i.appendSlash&&i.stripSlash))throw"options.appendSlash and options.stripSlash are mutually exclusive"}function f(a){for(var b,c=/\+/g,d=/([^&=]+)=?([^&]*)/g,e=function(a){return decodeURIComponent(a.replace(c," "))},f=a.split(/\?(.+)?/),g=f[0],h=f.slice(1,-1).join("&"),i={};b=d.exec(h);)i[e(b[1])]=e(b[2]);return{url:g,params:i}}function g(a,b){return b?c.path(a).search(b):c.path(a)}var h=this,i={appendSlash:!1,stripSlash:!1};h._p={_route:g,_endsWith:d,_overrideDefaults:e,_deconstructUrlPath:f},h.init=function(b){this._hasInit||(e(b),h._hasInit=!0,h._isClearing=!1,h._isRouting=!1,h._routeStack=[],a.$on("$routeChangeSuccess",function(a,b,c){return h._isClearing?void(h._isClearing=!1):void(!h._isRouting&&c&&(b.originalPath===h.peakRouteStack().url&&h._routeStack.pop(),h._isRouting=!0,h.pushToRouteStack(c.originalPath,c.params),h._isRouting=!1))}))},h.peakRouteStack=function(){return h._routeStack[h._routeStack.length-1]||{}},h.pushToRouteStack=function(a,b){b=b||{};var c=f(a);b.params||(a=c.url,b.params=c.params),i.appendSlash&&!d(a,"/")&&(a+="/"),i.stripSlash&&d(a,"/")&&(a=a.substring(0,a.length-1)),h.peakRouteStack().url!==a&&h._routeStack.push({url:a,params:b.params,label:b.label})},h.routeTo=function(a,b){h._isRouting||(b=b||{},h._isRouting=!0,b.clearStack&&h.clearRouteStack(),g(a,b.params),h._isRouting=!1)},h.back=function(){if(h.isBackRouteAvailable()){var a=h._routeStack.pop();return h._isClearing=!0,b.location.referrer===a.url?b.location.back():g(a.url,a.params)}},h.isBackRouteAvailable=function(){return!!h._routeStack.length},h.clearRouteStack=function(){h._routeStack.length=0,h._isClearing=!0},h.getRouteStack=function(){return h._routeStack},h.getDefaultOptions=function(){return i}}])}(angular.module("ngNavigation",[]));